# User-Centred Latency Visualisation: Opening a Large Worksheet (First Rows vs Last Row)

This directory contains a plotting script used to **visualise measured runtimes for opening a large worksheet** under two access patterns:

1. **first rows** (opening/reading the beginning of the worksheet)
2. **last row** (jumping to / accessing the end of the worksheet)

The script does **not** execute benchmarks itself; it reads pre-recorded runtime measurements from CSV files and produces a publication-ready boxplot.

## Script

- `generate_boxplot_run_times_to_open_large_sheet.py`  
  Reads runtime measurements from six CSV files (first vs last case per program) and generates a horizontal boxplot grouped by program.

## Input Data

The script expects six CSV files, each containing a column named `Time (seconds)`.

The CSV files are located in the following subdirectories relative to this folder:

### Dart Excel package
- `parse_large_sheet_excel_package/run_times_to_open_worksheet_dart_excel_package_first.csv`
- `parse_large_sheet_excel_package/run_times_to_open_worksheet_dart_excel_package_last.csv`

### Microsoft Excel (PowerShell/COM)
- `parse_large_sheet_microsoft_excel/run_times_to_open_worksheet_powershell_first.csv`
- `parse_large_sheet_microsoft_excel/run_times_to_open_worksheet_powershell_last.csv`

### Spreadsheet Data Extractor (SDE)
- `parse_large_sheet_sde/run_times_to_open_worksheet_sde_first.csv`
- `parse_large_sheet_sde/run_times_to_open_worksheet_sde_last.csv`

Each CSV represents repeated measurements of worksheet opening latency for the corresponding program and access pattern.

## Visualisation Details

- A **horizontal boxplot** is generated with **two cases per program** (first vs last).
- The x-axis uses a **logarithmic scale (base 10)** to accommodate large runtime differences.
- Zero values are replaced by a small positive constant to allow plotting on a log scale.
- Major ticks are placed at powers of ten; minor ticks use 2/4/6/8 within each decade.
- Two horizontal separator lines visually group the three programs.

The plot is ordered (and labelled) as:

1. SDE (first rows), SDE (last row)
2. Microsoft Excel (first rows), Microsoft Excel (last row)
3. Dart Excel package (first rows), Dart Excel package (last row)

## Output

The script produces a publication-ready [PDF Chart](generate_boxplot_run_times_to_open_large_sheet.pdf).

## Re-running Measurements

This script **does not re-run performance measurements**.

To regenerate the CSV input data, the corresponding benchmark scripts must be
executed in their respective directories:

### Dart Excel package benchmark
- `parse_large_sheet_excel_package/parse_large_sheet_excel_package_test.dart`  
  → writes:
  - `run_times_to_open_worksheet_dart_excel_package_first.csv`
  - `run_times_to_open_worksheet_dart_excel_package_last.csv`

### Microsoft Excel (PowerShell/COM) benchmark
- `parse_large_sheet_microsoft_excel/parse_large_file_microsoft_excel.ps1`  
  → writes:
  - `run_times_to_open_worksheet_powershell_first.csv`
  - `run_times_to_open_worksheet_powershell_last.csv`

### Spreadsheet Data Extractor (SDE) benchmark
- `parse_large_sheet_sde/parse_large_sheet_sde_test.dart`  
  → writes:
  - `run_times_to_open_worksheet_sde_first.csv`
  - `run_times_to_open_worksheet_sde_last.csv`

After re-running these benchmark scripts, the boxplot can be regenerated by
executing the Python visualisation script in this directory.

## Intended Use

This script is part of the artifact accompanying the paper and is intended for
**result reproduction and inspection**, not for benchmark execution. Runtime
measurements are obtained separately and provided to the script as CSV input.
